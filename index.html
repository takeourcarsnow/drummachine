<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CHIP-TRAX — 8‑bit Drum Machine + Synth</title>
<link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="wrap">
    <div class="ascii" aria-hidden="true">
<pre>
   8-bit chiptune drum machine + mono synth • NES/ASCII vibe
   Space: Play/Stop • Z/S/X/D/C... = Keys • Click pads to toggle (Alt=Accent)
</pre>
    </div>

    <div class="row panel">
      <div class="title">Transport & Groove</div>
      <div class="controls">
        <button class="btn" id="playBtn" aria-label="Play/Stop">▶ Play</button>
        <button class="btn" id="tapBtn" title="Tap Tempo">Tap</button>
        <div class="ctrl" title="Beats Per Minute">
          <label for="bpm">BPM</label>
          <input type="range" id="bpm" min="40" max="240" value="120" />
          <input type="number" id="bpmNum" min="40" max="240" value="120" />
        </div>
        <div class="ctrl" title="Swing pairs of 16ths">
          <label for="swing">Swing</label>
          <input type="range" id="swing" min="0" max="0.6" step="0.01" value="0.0" />
          <span class="tiny" id="swingTxt">0%</span>
        </div>
        <div class="ctrl" title="Humanize timing and level">
          <label for="human">Humanize</label>
          <input type="range" id="human" min="0" max="30" step="1" value="0" />
          <span class="tiny" id="humanTxt">0ms</span>
        </div>
        <div class="ctrl" title="Randomize / Clear / Save / Load / Share">
          <label>Tools</label>
          <button class="btn" id="randomizeBtn">Randomize</button>
          <button class="btn" id="clearBtn">Clear</button>
          <button class="btn" id="saveBtn">Save</button>
          <button class="btn" id="loadBtn">Load</button>
          <button class="btn" id="shareBtn">Share</button>
        </div>
        <div class="ctrl">
          <label>Scale</label>
          <span class="badge">16 Steps • 4 Tracks</span>
          <span class="inline-note">Alt-click pad = accent</span>
        </div>
        <div class="ctrl" title="Master Volume">
          <label>Master</label>
          <input type="range" id="masterVol" min="0" max="1" step="0.01" value="0.9">
        </div>
      </div>
    </div>

    <div class="row panel">
      <div class="title">Drum Machine</div>

      <div class="grid grid-head" id="gridHead">
        <div class="track-name tiny" aria-hidden="true">STEP</div>
        <!-- numbers injected -->
      </div>

      <div class="grid" id="grid" aria-label="Drum grid">
        <!-- Rows injected -->
      </div>
      <div class="vol-row" aria-label="Track Volume">
        <span class="tiny">Track Volumes:</span>
        <span class="tiny" style="color:var(--fg); width:64px; display:inline-block">KICK</span><input type="range" min="0" max="1" step="0.01" value="0.9" id="vol0" aria-label="Kick Volume">
        <span class="tiny" style="color:var(--fg); width:64px; display:inline-block">SNARE</span><input type="range" min="0" max="1" step="0.01" value="0.8" id="vol1" aria-label="Snare Volume">
        <span class="tiny" style="color:var(--fg); width:64px; display:inline-block">HAT</span><input type="range" min="0" max="1" step="0.01" value="0.65" id="vol2" aria-label="Hat Volume">
        <span class="tiny" style="color:var(--fg); width:64px; display:inline-block">CLAP</span><input type="range" min="0" max="1" step="0.01" value="0.7" id="vol3" aria-label="Clap Volume">
      </div>
      <div class="help">Tips: Click pads to toggle. Alt/Option adds Accent. Yellow frame shows the playing step. Randomize for instant fun. Use M/S to Mute or Solo tracks.</div>
    </div>

    <div class="row panel" style="gap:24px">
      <div style="min-width:300px; flex:1">
        <div class="title">Chippy Synth</div>
        <div class="controls" style="gap:12px">
          <div class="ctrl">
            <label>Wave</label>
            <select id="waveSel">
              <option value="square">Square 50%</option>
              <option value="pulse25">Pulse 25%</option>
              <option value="pulse125">Pulse 12.5%</option>
              <option value="triangle">Triangle</option>
            </select>
          </div>
          <div class="ctrl">
            <label>Attack</label><input type="range" id="att" min="0" max="0.5" step="0.005" value="0.01">
          </div>
          <div class="ctrl">
            <label>Decay</label><input type="range" id="dec" min="0" max="1.5" step="0.01" value="0.15">
          </div>
          <div class="ctrl">
            <label>Sustain</label><input type="range" id="sus" min="0" max="1.0" step="0.01" value="0.6">
          </div>
          <div class="ctrl">
            <label>Release</label><input type="range" id="rel" min="0" max="2.0" step="0.01" value="0.2">
          </div>
          <div class="ctrl">
            <label>Glide</label><input type="range" id="glide" min="0" max="0.2" step="0.005" value="0.02">
          </div>
          <div class="ctrl" title="Bit depth waveshaper">
            <label>Bits</label><input type="range" id="bits" min="4" max="16" step="1" value="8">
          </div>
          <div class="ctrl" title="Low-pass filter cutoff">
            <label>Cutoff</label><input type="range" id="cut" min="200" max="12000" step="1" value="8000">
          </div>
          <div class="ctrl" title="Low-pass resonance (Q)">
            <label>Reso</label><input type="range" id="reso" min="0.1" max="12" step="0.1" value="0.7">
          </div>
          <div class="ctrl" title="Vibrato LFO">
            <label>Vib Hz</label><input type="range" id="vibRate" min="0" max="12" step="0.1" value="0">
          </div>
          <div class="ctrl" title="Vibrato depth (cents)">
            <label>Vib Cents</label><input type="range" id="vibDepth" min="0" max="80" step="1" value="0">
          </div>
          <div class="ctrl">
            <label>Oct</label><input type="number" id="oct" min="-2" max="3" value="0">
          </div>
          <div class="ctrl">
            <label>Vol</label><input type="range" id="synthVol" min="0" max="1" step="0.01" value="0.75">
          </div>
        </div>

        <div class="help">
          Keyboard: Z S X D C V G B H N J M , (C–C) and Q 2 W 3 E R 5 T 6 Y 7 U I (upper octave). Hold keys for glide.
        </div>
      </div>

      <div style="flex:1; min-width:320px">
        <div class="title">Keys</div>
        <div class="keyboard" id="keyboard">
          <div class="kb-wrap" id="kbwrap">
            <!-- dynamically positioned -->
            <!-- We'll layout one octave C..B with overlayed black keys -->
          </div>
        </div>
      </div>
    </div>

    <div class="row panel">
      <div class="title">Legend</div>
      <div class="help">
        • Space: Play/Stop • Click pads to toggle • Alt-click for Accent • Drag to paint • Keyboard for synth: ZSXDCVGBHNJ,M for lower, Q2W3ER5T6Y7UI for upper<br>
        • Wave: Square/Pulse/Triangle • Bits: 4–16 bit waveshaper for crunch • Glide: portamento • ADSR + low-pass filter + optional vibrato<br>
        • Tools: Randomize, Clear, Save to local storage, Load, Share (copies URL) • All audio runs in-browser via WebAudio; no assets needed.
      </div>
    </div>

    <div class="footer">CHIP-TRAX • 8-bit drum machine + synth • made with WebAudio</div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script type="module" src="js/main.js"></script>
</body>
</html>